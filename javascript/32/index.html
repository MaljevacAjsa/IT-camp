<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      function makeRequest(location) {
        return new Promise((resolve, reject) => {
          console.log(`Making request to ${location}`);
          if (location === "Google") {
            resolve("Google says hi!");
          } else {
            reject("We can only talk to Google");
          }
        });
      }

      function processRequest(response) {
        return new Promise((resolve, reject) => {
          console.log("procesing response");
          resolve("Extra information" + response);
        });
      }
      makeRequest("Google");
      makeRequest("Google")
        .then((response) => {
          return processRequest(response);
        })
        .catch((res) => console.log(res));

      async function doWork(params) {
        try {
          const res = await processRequest("sh");
          console.log(res);
        } catch (e) {
          console.log(e);
        }
      }

      //       1. Delayed Callback Execution
      // Write a JavaScript function that takes a callback and invokes it after a delay of 2 second.

      function AfterDelay(callback) {
        setTimeout(callback, 2000);
      }
      function message() {
        console.log("Hello!");
      }
      AfterDelay(message);

      // 1.2.

      function afterDelay() {
        setTimeout(console.log("hello"), 3000);
      }
      afterDelay();
      setTimeout(console.log("hello2"), 3000);

      //       2. Callback to Promise Conversion

      // Write a JavaScript program that converts a callback-based function to a Promise-based function.

      function callbackBased(arg1, arg2, callback) {
        setTimeout(() => {
          let res = arg1 + arg2;
          if (res % 2 !== 0) {
            callback(null, res);
          } else {
            callback("new error,result is not odd!", res);
          }
        });
      }
      function promiseBased(arg1, arg2) {
        return new Promise((resolve, reject) => {
          callbackBased(arg1, arg2, (err, result) => {
            if (err) {
              reject(err);
            } else {
              resolve(result);
            }
          });
        });
      }

      ///////////////////////////////

      let obecanje = new Promise((resolve, reject) => {
        let uspeh = true;
        if (uspeh) {
          resolve("Uspeli smo jej. We did it jej! Jej we did it!");
        } else {
          reject("Tu bed gajz... bam bamm bammm!!!!!!!");
        }
      });

      obecanje
        .then((res) => {
          console.log("res");
        })
        .catch((res) => {
          console.log("res");
        });

      //         8. Repeated Execution with setInterval
      // Write a JavaScript program to implement a function that executes a given function repeatedly at a fixed interval using 'setInterval()'.

      const func = function () {
        console.log("ajsa");
      };

      const intervalId = setInterval(func, 2000);

      const stopFunc = function (id) {
        clearInterval(id);
      };

      setTimeout(() => stopFunc(intervalId), 6000);

      //       Create a Simple Promise:
      // 1. Write a JavaScript function that returns a Promise that resolves with a "Hello, World!" message after 1 second.

      function simplePromise() {
        return new Promise((resolve) => {
          setTimeout(() => {
            resolve("ajsa");
          }, 1000);
        });
      }
      simplePromise().then((message) => {
        console.log(message);
      });

      function simplyPromise(name) {
        return new Promise((resolve, reject) => {
          if (name == "ajsa") {
            resolve("Bujrum akice");
          } else {
            reject("MARS NZM TE");
          }
        });
      }

      simplyPromise("asa")
        .then((msg) => console.log(msg))
        .catch((msg) => console.log(msg));
    </script>
  </body>
</html>
